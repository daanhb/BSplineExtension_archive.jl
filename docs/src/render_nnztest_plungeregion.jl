using PGFPlotsX, DocumentPGFPlots, LaTeXStrings
ns2d1 = 10:30:1000
    AAZA_Afactors2d1 = [3.06218, 0.608901, 0.348118, 0.243779, 0.188468, 0.197937, 0.167582, 0.143966, 0.126269, 0.0892264, 0.0802602, 0.0735587, 0.085777, 0.0792717, 0.0579443, 0.0683593, 0.0642981, 0.0480332, 0.0455255, 0.0545466, 0.0409645, 0.0388083, 0.0471062, 0.0356152, 0.0342996, 0.0416338, 0.0400119, 0.0383854, 0.0292703, 0.0359684, 0.0275221, 0.0336443, 0.0257087, 0.0314769]
    AAZA_Nfactors2d1 = [96.52, 24.705, 14.1576, 9.9108, 7.6658, 6.36281, 5.38737, 4.62942, 4.0608, 3.63153, 3.26747, 2.99439, 2.75895, 2.54981, 2.35905, 2.19879, 2.06829, 1.95555, 1.85343, 1.75463, 1.66781, 1.57992, 1.51525, 1.44989, 1.39636, 1.3393, 1.2871, 1.23478, 1.19171, 1.15706, 1.12049, 1.0823, 1.04667, 1.01258]
    ns3d1 = 10:5:100
    AAZA_Afactors3d1 = [7.60384, 4.18921, 3.59459, 3.05895, 2.52735, 2.27998, 2.08981, 1.82362, 2.46418, 1.56982, 1.42393, 1.92301, 1.26565, 1.66504, 1.57651, 1.03472, 1.3839, 1.33116, 0.890535]
    AAZA_Nfactors3d1 = [1026.34, 808.996, 697.571, 596.412, 492.567, 445.654, 407.591, 356.144, 337.824, 306.724, 277.969, 263.861, 247.19, 228.366, 216.36, 202.147, 189.831, 182.701, 173.935]
    ns2d2 = 100:100:5000
    AAZA_Afactors2d2 = [0.243779, 0.157509, 0.104702, 0.0792717, 0.0630788, 0.0527078, 0.0356152, 0.0393708, 0.0352571, 0.0314769, 0.02881, 0.02076, 0.0243985, 0.0178483, 0.0166837, 0.0197449, 0.0146782, 0.0176287, 0.0131562, 0.015836, 0.0118742, 0.0113778, 0.0137318, 0.0131716, 0.0100128, 0.00960742, 0.00929264, 0.0112536, 0.010945, 0.0083166, 0.00806765, 0.00781134, 0.00957966, 0.00736599, 0.00711974, 0.00695929, 0.00852959, 0.00658476, 0.00641502, 0.00790749, 0.00771678, 0.00595268, 0.00581626, 0.007183, 0.00704198, 0.00542771, 0.00673587, 0.00521206, 0.00645428, 0.00499792]
    AAZA_Nfactors2d2 = [9.9108, 5.0643, 3.36747, 2.54981, 2.0291, 1.69543, 1.44989, 1.26649, 1.13414, 1.01258, 0.926777, 0.845208, 0.784871, 0.726661, 0.679259, 0.63518, 0.597617, 0.567104, 0.535645, 0.509433, 0.483448, 0.46324, 0.441747, 0.423727, 0.407672, 0.391163, 0.378342, 0.362022, 0.352094, 0.338609, 0.328474, 0.318037, 0.308175, 0.299904, 0.289878, 0.283344, 0.274395, 0.268097, 0.261187, 0.254382, 0.248247, 0.242362, 0.236808, 0.231075, 0.226539, 0.220989, 0.216692, 0.212208, 0.207633, 0.20349]
    ns3d2 = 10:30:220
    AAZA_Afactors3d2 = [7.603840682788051,2.0898129193264516,1.2656467482223457,0.8905352752498701,0.6949050018908981,0.8160247575228131,0.6903906634609481,0.597984735943337]
    AAZA_Nfactors3d2 = [1026.336, 407.590875,247.18999416909622,173.935404,135.77510059171598,111.98390625,94.75075346260388,82.07475732531931]
@pgf pgfsize = {width=300,height=200}
P1 = @pgf Axis({legend_cell_align="left",ymode="log",xmode="log",pgfsize...},
    Plot({style="blue",mark="*",mark_size="1.5pt",forget_plot},Table(ns2d1.^2,AAZA_Afactors2d1)),
    Plot({style="blue",mark="*",mark_size="1.5pt"},Table(ns2d2.^2,AAZA_Afactors2d2)),
    LegendEntry("nnz" * L"(A-AZ^*A)" * "/nnz" * L"(A)"),
    Plot({style="red",mark="*",mark_size="1.5pt",forget_plot},Table(ns2d1.^2,AAZA_Nfactors2d1)),
    Plot({style="red",mark="*",mark_size="1.5pt"},Table(ns2d2.^2,AAZA_Nfactors2d2)),
    LegendEntry("nnz" * L"(A-AZ^*A)/N" ),
    Plot({style="black,dashed"},Table(ns2d1.^2,ns2d1.^(-1))),
    Plot({style="black,dashed"},Table(ns2d2.^2,ns2d2.^(-1))),
    )
P2 = @pgf Axis({legend_cell_align="left",ymode="log",xmode="log",pgfsize...},
    Plot({style="blue",mark="*",mark_size="1.5pt",forget_plot},Table(ns3d1.^3,AAZA_Afactors3d1)),
    Plot({style="blue",mark="*",mark_size="1.5pt"},Table(ns3d2.^3,AAZA_Afactors3d2)),
    LegendEntry("nnz" * L"(A-AZ^*A)" * "/nnz" * L"(A)"),
    Plot({style="red",mark="*",mark_size="1.5pt",forget_plot},Table(ns3d1.^3,AAZA_Nfactors3d1)),
    Plot({style="red",mark="*",mark_size="1.5pt"},Table(ns3d2.^3,AAZA_Nfactors3d2)),
    LegendEntry("nnz" * L"(A-AZ^*A)/N" ),
    Plot({style="black,dashed"},Table(ns3d1.^3,4e2ns3d1.^(-1))),
    Plot({style="black,dashed"},Table(ns3d2.^3,4e2ns3d2.^(-1))),)

imgpath = joinpath(splitdir(@__FILE__())[1], "man", "figs")
DocumentPGFPlots.savefigs(joinpath(imgpath,"AAZA_Afactors_Nfactors2d"), P1)
DocumentPGFPlots.savefigs(joinpath(imgpath,"AAZA_Afactors_Nfactors3d"), P2)
